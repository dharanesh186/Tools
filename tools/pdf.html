<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PDF Merge & Split Tool</title>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 700px; margin: auto; padding: 20px; }
    h2 { margin-top: 30px; }
    button { padding: 8px 14px; margin-top: 10px; cursor: pointer; }
    input { margin-top: 10px; width: 100%; }
  </style>
</head>
<body>

<h1>PDF Merge & Split Tool</h1>

<h2>Merge PDFs</h2>
<input type="file" id="mergeFiles" accept="application/pdf" multiple>
<br>
<button onclick="mergePDFs()">Merge PDFs</button>

<h2>Split (Demerge) PDF</h2>
<input type="file" id="splitFile" accept="application/pdf">
<br>
<label>Pages (example: 1-3 or 5):</label><br>
<input type="text" id="pageRange" placeholder="e.g. 1-3">
<br>
<button onclick="splitPDF()">Split PDF</button>

<script>
const { PDFDocument } = PDFLib;

async function mergePDFs() {
  const files = document.getElementById('mergeFiles').files;
  if (files.length < 2) { alert("Select at least 2 PDFs"); return; }

  const mergedPdf = await PDFDocument.create();
  for (const file of files) {
    const bytes = await file.arrayBuffer();
    const pdf = await PDFDocument.load(bytes);
    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
    pages.forEach(page => mergedPdf.addPage(page));
  }

  downloadPDF(await mergedPdf.save(), "merged.pdf");
}

async function splitPDF() {
  const file = document.getElementById('splitFile').files[0];
  const range = document.getElementById('pageRange').value;
  if (!file || !range) { alert("Select PDF and enter page range"); return; }

  const bytes = await file.arrayBuffer();
  const pdf = await PDFDocument.load(bytes);
  const newPdf = await PDFDocument.create();

  let [start, end] = range.includes("-")
    ? range.split("-").map(n => parseInt(n) - 1)
    : [parseInt(range) - 1, parseInt(range) - 1];

  if(start < 0 || end >= pdf.getPageCount() || start > end){ alert("Invalid page range"); return; }

  const pages = await newPdf.copyPages(pdf, Array.from({length: end-start+1}, (_, i)=>start+i));
  pages.forEach(p=>newPdf.addPage(p));

  downloadPDF(await newPdf.save(), "split.pdf");
}

function downloadPDF(bytes, name){
  const blob = new Blob([bytes], {type:"application/pdf"});
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = name;
  link.click();
}
</script>

</body>
</html>
