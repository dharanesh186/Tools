<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title> üìÑ PDF Merge & Demerge | Merge & Split</title>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <style>
    :root {
      --space-dark: #0b0d17;
      --nebula-purple: #6e45e2;
      --star-white: #f8f9fa;
      --galaxy-blue: #243b55;
    }

    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      max-width: 800px; 
      margin: auto; 
      padding: 40px 20px; 
      background: radial-gradient(circle at center, #1b2735 0%, #090a0f 100%);
      color: var(--star-white);
      min-height: 100vh;
    }

    /* Background Star Animation */
    #stars-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      background-image: 
        radial-gradient(1px 1px at 20px 30px, #eee, rgba(0,0,0,0)),
        radial-gradient(2px 2px at 40px 70px, #fff, rgba(0,0,0,0)),
        radial-gradient(1.5px 1.5px at 50px 160px, #ddd, rgba(0,0,0,0)),
        radial-gradient(2px 2px at 90px 40px, #fff, rgba(0,0,0,0));
      background-size: 200px 200px;
      animation: twinkle 5s ease-in-out infinite alternate;
    }

    @keyframes twinkle { from { opacity: 0.3; } to { opacity: 0.8; } }

    h1 { 
      text-align: center; 
      margin-bottom: 40px; 
      text-transform: uppercase;
      letter-spacing: 3px;
      text-shadow: 0 0 15px rgba(110, 69, 226, 0.7);
    }

    /* Tool Sections (Glassmorphism) */
    .section-card {
      background: rgba(255, 255, 255, 0.05);
      padding: 30px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      margin-bottom: 30px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    h2 { 
      margin-top: 0; 
      font-size: 1.4rem; 
      color: #a287f4; 
      display: flex;
      align-items: center;
      gap: 10px;
    }

    label { display: block; margin-top: 15px; color: #ccc; font-size: 0.9rem; }

    /* Input & Button Styling */
    input[type="file"], input[type="text"] {
      margin-top: 10px;
      width: 100%;
      padding: 12px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: white;
      box-sizing: border-box;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-top: 20px;
      background: var(--nebula-purple);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(110, 69, 226, 0.4);
    }

    button:hover {
      background: #8057f5;
      transform: translateY(-2px);
      box-shadow: 0 0 20px rgba(110, 69, 226, 0.6);
    }

    .back-btn {
      display: inline-block;
      margin-bottom: 20px;
      color: #888;
      text-decoration: none;
      font-size: 0.9rem;
    }
    .back-btn:hover { color: var(--star-white); }

  </style>
</head>
<body>

<div id="stars-container"></div>

<a href="../index.html" class="back-btn">‚Üê Back to Mission Control</a>

<h1> üìÑPDF Merge & Demerge</h1>

<div class="section-card">
  <h2>üìÇ Merge Cosmic Files</h2>
  <label>Select two or more PDF files to combine:</label>
  <input type="file" id="mergeFiles" accept="application/pdf" multiple>
  <button onclick="mergePDFs()">Execute Merge</button>
</div>

<div class="section-card">
  <h2>‚úÇÔ∏è Split (Demerge)</h2>
  <label>Upload a PDF to extract pages:</label>
  <input type="file" id="splitFile" accept="application/pdf">
  <label>Target Page Range:</label>
  <input type="text" id="pageRange" placeholder="e.g. 1-3 or 5">
  <button onclick="splitPDF()">Execute Split</button>
</div>

<script>
const { PDFDocument } = PDFLib;

async function mergePDFs() {
  const files = document.getElementById('mergeFiles').files;
  if (files.length < 2) { alert("Select at least 2 PDFs"); return; }

  const mergedPdf = await PDFDocument.create();
  for (const file of files) {
    const bytes = await file.arrayBuffer();
    const pdf = await PDFDocument.load(bytes);
    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
    pages.forEach(page => mergedPdf.addPage(page));
  }

  downloadPDF(await mergedPdf.save(), "merged_nebula.pdf");
}

async function splitPDF() {
  const file = document.getElementById('splitFile').files[0];
  const range = document.getElementById('pageRange').value;
  if (!file || !range) { alert("Select PDF and enter page range"); return; }

  const bytes = await file.arrayBuffer();
  const pdf = await PDFDocument.load(bytes);
  const newPdf = await PDFDocument.create();

  let [start, end] = range.includes("-")
    ? range.split("-").map(n => parseInt(n) - 1)
    : [parseInt(range) - 1, parseInt(range) - 1];

  if(start < 0 || isNaN(start) || end >= pdf.getPageCount() || start > end){ 
    alert("Invalid page range"); 
    return; 
  }

  const pages = await newPdf.copyPages(pdf, Array.from({length: end-start+1}, (_, i)=>start+i));
  pages.forEach(p=>newPdf.addPage(p));

  downloadPDF(await newPdf.save(), "split_nebula.pdf");
}

function downloadPDF(bytes, name){
  const blob = new Blob([bytes], {type:"application/pdf"});
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = name;
  link.click();
}
</script>

</body>
</html>